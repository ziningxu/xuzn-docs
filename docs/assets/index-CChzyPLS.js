import{d as C,k as g,o as k,g as h,w as i,a as m,e as o,x as v,am as R,an as P,R as $,m as V,ah as W,q as B,A,Q as T,a0 as x,j as I,ao as L,r as f,b as w,F as q,ap as z,aq as N}from"./index-yT4Q7vfC.js";const D=C({__name:"indexTable",props:{formModel:{},tableApi:{}},setup(s){const r=g(()=>[{key:"select",label:"多选",type:"selection",align:"center",width:65,fixed:"left"},{key:"index",type:"index",align:"center",label:"序号",width:65,fixed:"left"},{key:"name",label:"用户名",minWidth:120,align:"center"},{key:"age",label:"年龄",width:80,align:"center"},{key:"gender",label:"性别",width:80,align:"center"},{key:"email",label:"邮箱",minWidth:300,align:"center"},{key:"phone",label:"电话",width:180,align:"center"},{key:"address",label:"地址",minWidth:600},{key:"address1",prop:"address",minWidth:600,label:"为了出现滚动条1"},{key:"address2",prop:"address",minWidth:600,label:"为了出现滚动条2"},{key:"ops",label:"操作",align:"center",width:172,fixed:"right"}]),l=g(()=>[{key:"name",label:"用户名"},{key:"age",label:"年龄"},{key:"gender",label:"性别"},{key:"email",label:"邮箱",hidden:!0},{key:"phone",label:"电话",hidden:!0},{key:"address",label:"地址",hidden:!0}]);return(t,n)=>{var u;return k(),h(o(V),{tableApi:t.tableApi,columns:r.value,"row-key":"id",title:(u=t.$route.meta)==null?void 0:u.title},{filter_form:i(()=>[m(o($),{"layout-type":"lr",model:t.formModel,labelWidth:"auto",items:l.value,onSubmit:n[0]||(n[0]=p=>t.tableApi.onCurrentChange(1)),onReset:n[1]||(n[1]=p=>t.tableApi.onCurrentChange(1))},null,8,["model","items"])]),ops:i(p=>[v(t.$slots,"default",R(P(p)))]),bar_right:i(()=>[v(t.$slots,"bar_right")]),_:3},8,["tableApi","columns","title"])}}});async function F(s={}){return await W(600),{rows:Y(s.current,s.size),total:300}}async function j(s={}){console.warn("待完善")}async function Q(s={}){console.warn("待完善")}async function U(s={}){console.warn("接口待完善")}function Y(s,r){const l=[];for(let t=0;t<r;t++){const n=(s-1)*r+1+t;l.push({id:n,name:"姓名_"+n,age:29,gender:"男",email:`emailemailemail${n}@example.com`,phone:"13500135050",address:`江苏省南京市玄武区沙河县南山村20巷8号沙河县南山村20巷8号8088-${n}`})}return l}const G=C({__name:"rowModify",props:{modifyApi:{},tableApi:{},onEnd:{type:Function}},setup(s,{expose:r}){const l=s,t=l.modifyApi.state,n=l.modifyApi.model,u=B(),p={name:[{required:!0,message:"请输入用户名"}]},_=g(()=>[{key:"name",label:"用户名"},{key:"age",label:"年龄"},{key:"gender",label:"性别"},{key:"email",label:"邮箱"},{key:"phone",label:"电话"},{key:"address",label:"地址"}]);function y(){var c;const e={...n};(c=u.value)==null||c.validate().then(async()=>{var b;t.type==="edit"?(await Q(e),A.success("编辑成功")):t.type==="add"&&(await j(e),A.success("新增成功")),l.tableApi.onSearch(),t.show=!1,(b=l.onEnd)==null||b.call(l,"submit")})}function a(){var e;l.tableApi.onSearch(),t.show=!1,(e=l.onEnd)==null||e.call(l,"cancel")}return r({onCancel:a,onSubmit:y}),(e,c)=>(k(),h(o($),{ref_key:"formRef",ref:u,items:_.value,model:o(n),rules:p,disabled:o(t).readonly,"label-width":"100px"},null,8,["items","model","disabled"]))}}),J=C({__name:"index",setup(s){const r=T({}),l=x([]),t=I({async api(a){return F({current:a.current,size:a.size,params:{...r}})}});t.onCurrentChange(1);const n=L(p),u=x();function p(a){return a?{...a}:{}}const _=g(()=>[{key:"详情",onClick:({row:a})=>n.onShow(a)},{key:"编辑",onClick:({row:a})=>n.onEdit(a)},{key:"删除",onClick:({row:a})=>y([a]),confirmText:"确认删除吗？"}]);function y(a=l.value){U({ids:a.map(e=>e.userId)}).then(()=>{t.onSearch(),A.success("删除成功")})}return(a,e)=>{const c=f("ElButton"),b=f("el-popconfirm"),E=f("el-main"),M=f("el-button"),S=f("el-container");return k(),h(S,{style:{height:"100%"}},{default:i(()=>[m(E,{style:{padding:"0"}},{default:i(()=>[m(D,{style:{height:"100%"},tableApi:o(t),formModel:r,onSelectionChange:e[2]||(e[2]=d=>l.value=d)},{default:i(({row:d})=>[m(o(z),{options:_.value,clickParams:{row:d}},null,8,["options","clickParams"])]),bar_right:i(()=>[m(c,{type:"primary",onClick:e[0]||(e[0]=d=>o(n).onAdd()),icon:"ElIconPlus"},{default:i(()=>e[4]||(e[4]=[w("新增")])),_:1}),m(b,{title:`确认删除选中（${l.value.length}）项吗？`,onConfirm:e[1]||(e[1]=()=>y())},{reference:i(()=>[m(c,{type:"danger",disabled:!l.value.length,icon:"ElIconDelete"},{default:i(()=>e[5]||(e[5]=[w("删除")])),_:1},8,["disabled"])]),_:1},8,["title"])]),_:1},8,["tableApi","formModel"])]),_:1}),m(o(N),{modelValue:o(n).state.show,"onUpdate:modelValue":e[3]||(e[3]=d=>o(n).state.show=d),title:o(n).getTypeText(),"destroy-on-close":""},{btns:i(()=>{var d;return[o(n).state.readonly?q("",!0):(k(),h(M,{key:0,type:"primary",onClick:(d=u.value)==null?void 0:d.onSubmit},{default:i(()=>e[6]||(e[6]=[w("保存")])),_:1},8,["onClick"]))]}),default:i(()=>[m(G,{ref_key:"rowModifyRef",ref:u,modifyApi:o(n),tableApi:o(t)},null,8,["modifyApi","tableApi"])]),_:1},8,["modelValue","title"])]),_:1})}}});export{J as default};
